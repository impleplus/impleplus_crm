<div class="page-body">
	<div class="container-xl">
 		<div class="col-12">
 			<div class="card">
 				<div class="card-body">
 					<ul class="nav nav-tabs" data-bs-toggle="tabs">
 						<li class="nav-item">
 							<a href="#tabs-fGRRLA" class="nav-link active" data-bs-toggle="tab">Information</a>
 						</li>
 
 					</ul>
 					<div class="card-body">
 						<div class="tab-content">
 							<div class="tab-pane active show" id="tabs-fGRRLA">
 								<form action="/quotation/save" class="needs-validation" id="frm-fGRRLA" method="post">
 									<div class="row " >
										<div class="col-6 dz undefined" data-dz="KjCvty" id="KjCvty" >
 
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Customer</label>
 											<div class="row g-2">
 											<div class="col">
 												<input type="hidden" name="customer_id" id="lookup_iHHlsp" value="<%=quotationRecord.customer_id%>">
 												<input type="text" name="customer_id_text" id="lookup_iHHlsp_text" value="<%=quotationRecord.firstname%>" required onkeydown="event.preventDefault()" class="form-control " >
 											</div>
 											<div class="col-auto">
 												<button type="button" href="#" class="btn btn-white btn-icon" aria-label="Button" data-title="Customer" data-varibale="customerRecords" data-url="/customer" data-headers="Customer" data-fields="firstname,lastname" data-select="id,firstname,address,province,country,zipcode,phone,email,taxid" data-target="lookup_iHHlsp,lookup_iHHlsp_text,input_DVKhWb,input_rvSWBo,input_zSVEUc,input_Fipmcp,input_iyTgHX,input_cVZbuy,input_iUHKnF" onclick="lookup.open(this)">
 													<svg class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7" /><line x1="21" y1="21" x2="15" y2="15" /></svg>
 												</button>
 											</div>
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Customer name</label>
 										<div>
 											<input type="text" name="customer" id="input_TkfDUb" maxlength="100" value="<%=quotationRecord.customer%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Customer address</label>
 										<div>
 											<input type="text" name="customer_address" id="input_DVKhWb" maxlength="100" value="<%=quotationRecord.customer_address%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Customer province</label>
 										<div>
 											<input type="text" name="customer_province" id="input_rvSWBo" maxlength="100" value="<%=quotationRecord.customer_province%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Customer country</label>
 										<div>
 											<input type="text" name="customer_country" id="input_zSVEUc" maxlength="100" value="<%=quotationRecord.customer_country%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Customer zipcode</label>
 										<div>
 											<input type="text" name="customer_zipcode" id="input_Fipmcp" maxlength="100" value="<%=quotationRecord.customer_zipcode%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Customer phone</label>
 										<div>
 											<input type="text" name="customer_phone" id="input_iyTgHX" maxlength="100" value="<%=quotationRecord.customer_phone%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Customer email</label>
 										<div>
 											<input type="text" name="customer_email" id="input_cVZbuy" maxlength="100" value="<%=quotationRecord.customer_email%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Customer Tax Id</label>
 										<div>
 											<input type="text" name="taxid" id="input_iUHKnF" maxlength="100" value="<%=quotationRecord.taxid%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 
 										</div>
										<div class="col-6 dz undefined" data-dz="jkJbQq" id="jkJbQq" >
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Vendor</label>
 										<div>
 											<input type="text" name="vendor" id="input_lvTizn" maxlength="100" value="<%=quotationRecord.vendor%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Vendor address</label>
 										<div>
 											<input type="text" name="vendor_address" id="input_JjMvkK" maxlength="100" value="<%=quotationRecord.vendor_address%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Vendor province</label>
 										<div>
 											<input type="text" name="vendor_province" id="input_JVhQki" maxlength="100" value="<%=quotationRecord.vendor_province%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Vendor country</label>
 										<div>
 											<input type="text" name="vendor_country" id="input_tJVrsl" maxlength="100" value="<%=quotationRecord.vendor_country%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Vendor zipcode</label>
 										<div>
 											<input type="text" name="vendor_zipcode" id="input_gwkdfC" maxlength="100" value="<%=quotationRecord.vendor_zipcode%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Vendor phone</label>
 										<div>
 											<input type="text" name="vendor_phone" id="input_TIKXGS" maxlength="100" value="<%=quotationRecord.vendor_phone%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Vendor email</label>
 										<div>
 											<input type="text" name="vendor_email" id="input_iseMZk" maxlength="100" value="<%=quotationRecord.vendor_email%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 
 										</div>
									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Quotation no</label>
 										<div>
 											<input type="text" name="doc_no" id="input_xjJxHO" maxlength="100" value="<%=quotationRecord.doc_no%>" class="form-control " autocomplete="off" >
 										</div>
 									</div>
 
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Quotation date</label>
 										<div class="input-icon mb-2">
 											<input class="form-control datepicker " data-format="DD/MM/YYYY" name="doc_date" id="datepicker_zCrwxF" value="<%=moment(quotationRecord.doc_date).format('DD/MM/YYYY')%>" />
 											<span class="input-icon-addon">
 												<svg class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="5" width="16" height="16" rx="2" /><line x1="16" y1="3" x2="16" y2="7" /><line x1="8" y1="3" x2="8" y2="7" /><line x1="4" y1="11" x2="20" y2="11" /><line x1="11" y1="15" x2="12" y2="15" /><line x1="12" y1="15" x2="12" y2="18" /></svg>
 											</span>
 										</div>
 									</div>
 
									<hr class="" />

 							<div class="mb-3 col-md-12">
 								<div class="row">
 									<div class="d-flex">
 										<div class="form-label">Products</div>
 											<div class="ms-auto">
 												<div class="ms-2 d-inline-block">
 													<input type="button" value="Add" class="btn btn-light" onclick="_datasheet_JiMtVR.onAddRow()">
 												</div>
 												</div>
 									</div>
 									<div class="table-responsive">
 										<input type="hidden" name="datasheet_JiMtVR" id="datasheet_JiMtVR">
 										<table class="table table-vcenter card-table table-striped datasheet" data-id="datasheet_JiMtVR">
 											<thead>
 											</thead>
 											<tbody>
 											</tbody>
 										</table>
 									</div>
 								</div>
 							</div>
 
									<hr class="" />
									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Tax Rate (Percent)</label>
 										<div>
 											<input type="number" name="tax_rate" id="input_otQdNw" maxlength="100" value="<%=quotationRecord.tax_rate%>" required class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="form-group mb-3 col-md-12">
 										<label class="form-label">Discount</label>
 										<div>
 											<input type="number" name="discount" id="input_dTAKlF" maxlength="100" value="<%=quotationRecord.discount%>" required class="form-control " autocomplete="off" >
 										</div>
 									</div>
 									<div class="row " >
										<div class="col-10 dz " data-dz="aawNVS" id="aawNVS" >
 											<%if(accessAction.edit){%>
 												<button type="button" id="button_pCQobL" class="btn btn-fw btn-secondary" onclick="printExternal('/printform/quotation?id=<%=param.id%>')" >Print Quotation</button>
 											<%}%>
 
 										</div>
										<div class="col-2 dz text-right" data-dz="oNSBBp" id="oNSBBp" >
 											<%if(accessAction.edit){%> 
 												<div class="spinner-border" id="button_Ktbxeq_loading" role="status" style="display: none;"><span class="visually-hidden">Loading...</span></div> 
 												<button type="submit" id="button_Ktbxeq" class="btn btn-fw btn-primary btn-save" data-form="frm-fGRRLA" method-callback="" method-before="" >Save</button> 
 											<%}%>
 
 										</div>
									</div>
 
 
 								</form>
 							</div>
 
 						</div>
 					</div>
 				</div>
 			</div>
 		</div>
 	</div>
</div>

<%- contentFor('scripts') %>
<script type="text/javascript">
    var accessAction = [];
    var accessActionData = "<%-accessAction%>";
    var dataParam = '<%-JSON.stringify(param)%>';
    var param = {};
    if(dataParam != ""){
      param = JSON.parse('<%-JSON.stringify(param)%>');
    }    
    if(accessActionData != "" && accessActionData != undefined) {
        accessAction = JSON.parse(String.raw `<%-JSON.stringify(accessAction)%>`);
    }
    
var quotation_itemRecords = [];
var quotation_itemRecordsData = "<%-quotation_itemRecords%>";
if(quotation_itemRecordsData != "" && quotation_itemRecordsData != undefined) {
    quotation_itemRecords = JSON.parse(String.raw `<%-JSON.stringify(quotation_itemRecords)%>`);
}

var tableId = "datasheet_JiMtVR";
var _datasheet_JiMtVR;

setLookupValue_datasheet_JiMtVR = (data) => {
    var tableId = data[0];
    var rowId = data[1];
    var foundIndex = _datasheet_JiMtVR.items.findIndex(x => x.id == rowId);
    var elId = data[2];
    var elName = data[3];
    _datasheet_JiMtVR.items[foundIndex][elId] = data[4];
    _datasheet_JiMtVR.items[foundIndex][elName] = data[5];
    document.getElementById(tableId).value = JSON.stringify(_datasheet_JiMtVR.items);
}

0

onload = () => {
        
    _datasheet_JiMtVR = new DataSheet("datasheet_JiMtVR",[{"text":"Item","width":"70%"},{"text":"Qty","width":"10%"},{"text":"Unit price","width":"10%"},{"text":"Total","width":"10%"}],[{"field":"product_id","field_text":"product_name","type":"lookup","readonly":false},{"field":"quantity","type":"number","readonly":false,"addevent":"onchange=calculateTotal(this)"},{"field":"unitprice","type":"number","readonly":false,"addevent":"onchange=calculateTotal(this)"},{"field":"total","type":"number","readonly":true}],quotation_itemRecords,"/product","productRecords","Code,Name,Vendor,Price","code,name,vendor,price_sale","id,name");
    _datasheet_JiMtVR.init();
    if(!param.id){
	document.getElementById("input_otQdNw").value=7;
	document.getElementById("input_dTAKlF").value=0;
}
}
    
    

</script>